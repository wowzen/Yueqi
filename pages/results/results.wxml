
<view class="container">
  <view class="card">
    <image class="card-image" src="{{event.image || testImage}}" />
    <view class="card-body">
      <view class="activity">{{event.activity}}</view>
      <view class="occasion">For {{event.occasion}}</view>
      <view class="nickname">Organized by: {{event.creator_id.nickname}}</view>
      <view wx:if="{{event.confirmed_date != ''}}"> 
        <view>Event date & time: </view>
        <view>{{confirmedSlot.start_date}} to {{confirmedSlot.end_date}}</view>
      </view>
      <view wx:else class="">
        <view>Event date & time: To be confirmed by the organizer</view>
        <view>Participant response deadline: {{event.response_deadline}}</view>
    </view>
    </view>
  </view>

  
  <block wx:if="{{currentUser.id == event.creator_id.id}}">
   
      <view class="no-response" wx:if="{{slots[0].response_total == 0}}">No responded has been made to this event yet</view>
        
      <view wx:elif="{{event.confirmed_date == '' || confirmedSlot == undefined || changeDate == true}}">

        <view class="results-card1">
            <view class="header2">Select the event date</view>

              <radio-group bindchange="chooseDate">
                  
                <label class="timedate1" wx:for="{{slots}}" data-chosenSlot="{{slot.start_date}}" wx:for-item="slot" wx:key="id">
                  <view class="datetime-slot1">
                    <view class="date-cell1">
                      {{slot.start_date}} to {{slot.end_date}}
                        <radio class="radio" value="{{slot.id}}"/>
                        <view class="progress-bar1"><progress percent="{{slot.response_progress}}"></progress></view>
                        <!-- <view class="available">Participants available: {{slot.response_yes}}</view> -->
                    </view>
                  </view>
                </label>

              </radio-group>
            </view>
            <view class="total1" >Number of participant: {{slots[0].response_total}}</view>
        </view>
    
  
    <view wx:if="{{dateSelected && event.confirmed_date == ''}}">
      <button wx:if="{{!confirmedSlot || changeDate == false}}" class="button3" bindtap="{{deadlinePassed ? 'setFinalDate' : 'setFinalDateEarly'}}">Set final event date</button>
    </view>
    <view wx:elif="{{(dateSelected == true || event.confirmed_date.length != 0) && changeDate == false }}">
      <button  class="button" bindtap="changeFinalDate">Change event date</button>
    </view>

  </block>

<block wx:else> 
  <!-- event.creator_id.id != currentUser.id &&  -->

  <view wx:if="{{event.confirmed_date.length == 0 && availabilitySubmitted == true}}">
    <!-- <view>Your availability has been confirmed.</view>
    <view>More participants may yet provide availability.</view>
    <view>After the event organizer has set the final event date, you will receive a notification.</view> -->
    
    <view class="results-card">
      <view class="header2">Friends availability</view>
       <view  wx:for="{{slots}}" wx:for-item="slot" wx:key="id">
          <view class="datetime-slot">
            <view class="timedate">{{slot.start_date}} to {{slot.end_date}}</view>
            <view class="progress-bar"><progress percent="{{slot.response_progress}}"></progress></view>
            <!-- <view class="participants">Participants available: {{slot.response_yes}}</view> -->
          </view>
        </view>
    
    </view>

    <view class="total">Number of participants: {{slots[0].response_total}}</view>

    </view>
  </block>
  </view>
